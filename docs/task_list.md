# AI-Genesis â€” Task List

ĞÑ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ğ¾Ğ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°.
ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ° Ğ½Ğ° **15-30 Ğ¼Ğ¸Ğ½ÑƒÑ‚** ĞºĞ¾Ğ´Ğ¸Ğ½Ğ³Ğ°.
Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ ÑĞ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ¿Ğ¾ Ñ„Ğ°Ğ·Ğ°Ğ¼ Ğ¸Ğ· `development_roadmap.md`.

**ĞĞ±Ğ¾Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ:**
- `[x]` â€” Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾
- `[ ]` â€” Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
- `Depends:` â€” Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ (Ğ½ĞµĞ»ÑŒĞ·Ñ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ, Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ñ‹)
- `Verify:` â€” ĞºĞ°Ğº Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ñ‡Ñ‚Ğ¾ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° ÑĞ´ĞµĞ»Ğ°Ğ½Ğ°
- `File:` â€” Ñ„Ğ°Ğ¹Ğ»(Ñ‹), ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ÑÑ Ğ¸Ğ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ

**Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ:**
- âœ… Phase 0: Environment & Infrastructure â€” **10/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** âœ…
- âœ… Phase 1: "Dead World" â€” Core Engine â€” **22/22 Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** âœ…
- âœ… Phase 2: API & WebSocket â€” **10/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!**
- âœ… Phase 3: Event Bus & Watcher â€” **10/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!**
- âœ… Phase 4: Sandbox & Hot-Reload â€” **10/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!**
- ğŸ”„ Phase 5: LLM Integration â€” **8/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾** (T-053..T-060 âœ…, T-061..T-062 â³)

**ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº:** 2026-02-17 (Phase 5 Integration)
- âœ… Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚: ÑÑƒÑ‰Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞ¿Ğ°Ğ²Ğ½ÑÑ‚ÑÑ, ÑÑ‚Ğ°Ñ€ĞµÑÑ‚, ÑƒĞ¼Ğ¸Ñ€Ğ°ÑÑ‚ Ğ¾Ñ‚ Ğ³Ğ¾Ğ»Ğ¾Ğ´Ğ° (age=100), Ñ€ĞµÑĞ¿Ğ°Ğ²Ğ½ÑÑ‚ÑÑ
- âœ… Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 100 Ñ‚Ğ¸ĞºĞ¾Ğ²: `entities=20, avg_energy=100.0, resources=~5000+`
- âœ… Unit tests: 82+ Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¿Ğ¾ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‚ Ğ²ÑĞµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Phase 1-4 (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ sandbox)
- âœ… **REST API Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚:** GET /api/world/state, POST /api/world/params, GET /api/stats
- âœ… **Swagger UI Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½:** http://localhost:8000/docs
- âœ… **WebSocket ÑÑ‚Ñ€Ğ¸Ğ¼ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚:** Binary protocol @ 30 FPS, frontend Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ @ 60 FPS
- âœ… **Frontend Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½:** http://localhost:5173 â€” real-time Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ 20 ĞœĞ¾Ğ»Ğ±Ğ¾Ñ‚Ğ¾Ğ²
- ğŸš€ **Phase 2 Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!**
- âœ… **Event Bus Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚:** Redis Pub/Sub Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼Ğ¸
- âœ… **Telemetry Pipeline:** Ğ¡Ğ½Ğ¸Ğ¼ĞºĞ¸ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 300 Ñ‚Ğ¸ĞºĞ¾Ğ² â†’ Redis (TTL 5 Ğ¼Ğ¸Ğ½) â†’ ch:telemetry
- âœ… **Watcher Agent:** Ğ”ĞµÑ‚ĞµĞºÑ†Ğ¸Ñ Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸Ğ¹ (Ğ³Ğ¾Ğ»Ğ¾Ğ´, Ğ²Ñ‹Ğ¼Ğ¸Ñ€Ğ°Ğ½Ğ¸Ğµ, Ğ¿ĞµÑ€ĞµĞ½Ğ°ÑĞµĞ»ĞµĞ½Ğ¸Ğµ) Ñ ĞºÑƒĞ»Ğ´Ğ°ÑƒĞ½Ğ¾Ğ¼
- âœ… **Feed Messages:** Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ²ÑĞ·ÑŒ Ñ‡ĞµÑ€ĞµĞ· ch:feed
- ğŸš€ **Phase 3 Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!**
- âœ… **CodeValidator:** AST-Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³, whitelist Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ², bannlist Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹, contract Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
- âœ… **RuntimePatcher:** Hot-reload Ñ‚Ñ€ĞµĞ¹Ñ‚Ğ¾Ğ² Ñ‡ĞµÑ€ĞµĞ· importlib, rollback Ğ½Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ…
- âœ… **Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ:** Patcher Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ² main.py ĞºĞ°Ğº Ñ„Ğ¾Ğ½Ğ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°
- âœ… **Evolution API:** POST /api/evolution/trigger, GET /api/mutations, GET /api/mutations/{id}/source
- âœ… **EvolutionForce:** ĞĞ¾Ğ²Ñ‹Ğ¹ event type Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ñ‹Ñ… Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ² ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸
- âœ… **ArchitectAgent + CoderAgent:** Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ LLM-Ñ†Ğ¸ĞºĞ» Ğ¾Ñ‚ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ° Ğ´Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ¼ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¸
- âœ… **EventBus fix:** sync Redis PubSub Ğ² background thread (Ñ„Ğ¸ĞºÑ Ğ·Ğ°Ğ²Ğ¸ÑĞ°Ğ½Ğ¸Ñ async)
- ğŸš€ **Phase 4 Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!** | **Phase 5 â€” 8/10 Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾**

---

## Phase 0: Environment & Infrastructure (10 tasks, ~3.5 hours)

Setup Docker, Redis, Ollama, project skeleton â€” Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ¸Ğ· Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸.

### 0.1 Project Scaffold

- [x] **T-001** Create directory structure and empty `__init__.py` files
  - File: all directories from `tech_stack.md` Section 2
  - Verify: `find backend -name __init__.py | wc -l` returns 6 (core, agents, sandbox, bus, api, backend)
  - Depends: â€”

- [x] **T-002** Create `backend/config.py` with Pydantic Settings
  - File: `backend/config.py`
  - Content: `Settings` class from `tech_stack.md` Section 8 (all env vars with defaults)
  - Verify: `python -c "from backend.config import Settings; s = Settings(); print(s.tick_rate_ms)"` prints `16`
  - Depends: T-001

- [x] **T-003** Create `backend/requirements.txt` with pinned dependencies
  - File: `backend/requirements.txt`
  - Content: fastapi, uvicorn, redis, httpx, pydantic, pydantic-settings, structlog, watchdog, pytest, pytest-asyncio, mypy
  - Verify: `pip install -r backend/requirements.txt` succeeds
  - Depends: T-001

- [x] **T-004** Create `.env.example` and `.gitignore`
  - File: `.env.example`, `.gitignore`
  - `.gitignore`: mutations/*.py (except __init__.py), .env, __pycache__, .mypy_cache, node_modules, dist
  - Verify: files exist, `git status` doesn't show .env
  - Depends: T-001

### 0.2 Docker & Ollama

- [x] **T-005** Create `Dockerfile.core` for Python backend
  - File: `Dockerfile.core`
  - Content: python:3.11-slim, WORKDIR /app, copy requirements, pip install, copy backend/, CMD uvicorn
  - Verify: `docker build -f Dockerfile.core -t genesis-core .` succeeds
  - Depends: T-003

- [x] **T-006** Create `docker-compose.yml` with 3 services: core, redis, ollama
  - File: `docker-compose.yml`
  - Services: core (port 8000), redis:7-alpine (port 6379), ollama/ollama (port 11434)
  - Volumes: `./mutations:/app/mutations`, `redis_data`, `ollama_models`
  - Resource limits per `tech_stack.md` Section 1.1
  - Verify: `docker compose config` validates without errors
  - Depends: T-005

- [x] **T-007** Add Ollama model pull script / healthcheck with startup wait
  - File: `scripts/setup_ollama.sh`, `docker-compose.yml` (extend healthcheck)
  - Content:
    - Script: `ollama pull llama3:8b` (WARNING: 4-5GB download, may take 10-20 min on slow internet)
    - Healthcheck: `curl -f http://localhost:11434/api/tags | grep llama3` (checks model is loaded, not just server running)
    - docker-compose: add `healthcheck` to ollama service with interval 10s, timeout 5s, retries 30 (allow 5 min for model download)
  - **CRITICAL:** Core service should have `depends_on: ollama: condition: service_healthy` to prevent startup crashes while Ollama is downloading model
  - Verify: script runs, `curl http://localhost:11434/api/tags` returns JSON with llama3, core waits for ollama to be healthy before starting
  - Depends: T-006

- [x] **T-008** Verify full Docker stack starts and services communicate
  - Action: `docker compose up -d`, verify redis-cli ping, curl ollama, curl core
  - Verify: all 3 containers healthy, `docker compose ps` shows all "Up"
  - Depends: T-006, T-007

### 0.3 Redis Connection

- [x] **T-009** Create Redis connection helper with async client
  - File: `backend/bus/__init__.py` (re-exports), internal helper in bus module
  - Content: `async def get_redis() -> Redis` factory, using `redis.asyncio.Redis.from_url(settings.redis_url)`
  - Verify: `pytest tests/bus/test_redis_connection.py` â€” connects, SET/GET works
  - Depends: T-002, T-003

- [x] **T-010** Create initial `mutations/` directory with `__init__.py` and `.gitkeep`
  - File: `mutations/__init__.py`, `mutations/.gitkeep`
  - Verify: directory exists, is importable as Python package
  - Depends: T-001

---

## Phase 1: "Dead World" â€” Core Engine (12 tasks, ~4.5 hours)

Ğ¯Ğ´Ñ€Ğ¾ ÑĞ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ğ¸: entity model, world loop, physics â€” Ğ±ĞµĞ· AI, Ğ±ĞµĞ· Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ğ°.

### 1.1 Data Models

- [x] **T-011** Create `BaseTrait` abstract class and `TraitExecutor`
  - File: `backend/core/traits.py`
  - Content: `class BaseTrait(Protocol)` with `async def execute(self, entity) -> None`, `TraitExecutor` with timeout wrapper (5ms hard limit, 2ms soft target), tick time budgeting (14ms total for all entities)
  - Verify: mypy passes, `TraitExecutor.execute_traits()` catches timeout, skips remaining entities if tick budget exceeded
  - Depends: T-001

- [x] **T-012** Create `BaseEntity` dataclass with fields and `update()` method
  - File: `backend/core/entity.py`
  - Fields: id, x, y, energy, max_energy, age, generation, dna_hash, traits, state, parent_id, born_at_tick, color, radius, metabolism_rate, deactivated_traits
  - Methods: `update()` calls TraitExecutor, `move(dx, dy)`, `consume_resource(r)`
  - Verify: `Entity` can be instantiated, `update()` iterates traits
  - Depends: T-011

- [x] **T-013** Create `DynamicRegistry` â€” in-memory Trait catalog with race condition protection
  - File: `backend/core/dynamic_registry.py`
  - Methods: `register(name, cls)`, `unregister(name)`, `get_all_traits()`, `get_trait(name)`, `get_snapshot() -> dict` (returns immutable copy for spawn), `unique_trait_count()`, `most_common_trait()`
  - Implementation: Use atomic dict replacement (create new dict, assign) instead of mutation. `get_snapshot()` returns `self._traits.copy()` to prevent race conditions during hot-reload.
  - Verify: register/get round-trip works, `get_snapshot()` returns independent copy, thread-safe via dict replacement
  - Depends: T-011

### 1.2 Entity Manager

- [x] **T-014** Create `EntityManager` â€” CRUD, spawn, remove
  - File: `backend/core/entity_manager.py`
  - Methods: `spawn(parent)`, `remove(entity)`, `alive()`, `count()`, `get(id)`
  - Internal: `dict[str, Entity]` for O(1) lookups
  - Verify: spawn 10 entities, remove 3, count() == 7
  - Depends: T-012

- [x] **T-015** Add spatial hash grid to `EntityManager` for collision detection
  - File: `backend/core/entity_manager.py` (extend)
  - Methods: `detect_collisions() -> list[tuple[Entity, Entity]]`, `nearby_entities(x, y, radius) -> list[Entity]`
  - Internal: grid cells of 50x50px, rebuild each tick
  - Verify: 2 entities at (10,10) and (15,15) collide; entity at (500,500) doesn't
  - Depends: T-014

### 1.3 World Physics & Environment

- [x] **T-016** Create `WorldPhysics` â€” gravity, friction, collision resolution
  - File: `backend/core/world_physics.py`
  - Functions: `apply_friction(entity, friction)`, `resolve_collision(a, b)`, `apply_bounds(entity, width, height)`
  - Verify: entity at x=2001 wraps or bounces, friction reduces velocity
  - Depends: T-012

- [x] **T-017** Create `Environment` â€” resource map, spawn, weather
  - File: `backend/core/environment.py`
  - Class: `Resource(x, y, amount)`, `Environment` with `respawn_resources(rate)`, `resource_density()`, `nearby_resources(x, y, radius)`
  - Verify: respawn adds resources, density calculated correctly
  - Depends: T-002

### 1.4 World Loop

- [x] **T-018** Create `CoreEngine` with async tick loop (skeleton)
  - File: `backend/core/engine.py` âœ…
  - Content: `async def run()` â€” infinite loop with `asyncio.sleep(tick_rate)`, tick counter, calls entity updates
  - Verify: loop runs 60 ticks in 1 second (within 5% tolerance) âœ… (16ms tick rate = ~62 FPS)
  - Depends: T-014, T-016, T-017

- [x] **T-019** Add lifecycle logic to tick loop: death, respawn, energy drain
  - File: `backend/core/engine.py` (extend) âœ…
  - Content: check energy <= 0 â†’ death, age > max_age â†’ death, auto-respawn if count < MIN_POPULATION âœ…
  - **CRITICAL:** Use `registry.get_snapshot()` when assigning traits to new entities (in spawn function) âœ…
  - Verify: spawn 5 entities with energy=1, after 2 ticks they die, new ones respawn âœ… (entities die at age=100, respawn immediately)
  - Depends: T-018, T-013

- [x] **T-020** Add statistics logging and telemetry (modified scope)
  - File: `backend/core/engine.py` (extend) âœ…
  - Content: Log statistics every 100 ticks: `[Tick N] Entities: X, AvgEnergy: Y, Resources: Z`
  - Note: Implemented structured statistics logging instead of DeathRecord dataclass (sufficient for Phase 1)
  - Verify: logs show periodic statistics with entity count, avg energy, resources âœ…
  - Depends: T-019

- [x] **T-021** Create `backend/main.py` entry point â€” launch engine standalone
  - File: `backend/main.py` âœ…
  - Content: `asyncio.run(main())`, creates Settings, Redis connection, EntityManager, Environment, Physics, Registry, Engine âœ…
  - Includes graceful shutdown with signal handlers (SIGTERM, SIGINT) âœ…
  - Updated `Dockerfile.core` to run simulation instead of FastAPI âœ…
  - Verify: `python -m backend.main` starts, prints tick numbers, Ctrl+C stops gracefully âœ…
  - Depends: T-018, T-002

- [x] **T-022** Write unit tests for Phase 1 (entity, manager, physics, engine)
  - File: `tests/core/test_entity.py` âœ…, `tests/core/test_entity_manager.py` âœ…, `tests/core/test_engine.py` âœ…
  - Additional: `tests/core/test_environment.py` âœ…, `tests/core/test_world_physics.py` âœ…, `tests/core/test_dynamic_registry.py` âœ…
  - Coverage: BaseEntity (lifecycle, traits, death), EntityManager (CRUD, spatial hash, collisions), CoreEngine (spawning, death, lifecycle), Environment (resources), WorldPhysics (boundaries, collisions), DynamicRegistry (thread safety)
  - Verify: `pytest tests/core/ -v` â€” all green, mypy passes âœ…
  - Depends: T-021

---

## Phase 2: "Window to the World" â€” API & WebSocket (10 tasks, ~3.5 hours)

FastAPI, REST endpoints, WebSocket broadcast â€” Molbot'Ñ‹ Ğ²Ğ¸Ğ´Ğ½Ñ‹ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ.

### 2.1 FastAPI Setup

- [x] **T-023** Create FastAPI app factory with dependency injection
  - File: `backend/api/app.py` âœ…
  - Content: `create_app(engine, redis)` with Dependency Injection pattern (receives engine, doesn't create it) âœ…
  - CORS configured (allow origins * for dev) âœ…
  - Includes health endpoints (`/`, `/health`) and Swagger UI (`/docs`) âœ…
  - Integration: `main.py` runs both engine + uvicorn via `asyncio.gather()` âœ…
  - Verify: Server starts at http://0.0.0.0:8000, `/docs` accessible âœ…
  - Depends: T-021, T-009

- [x] **T-024** Create `GET /api/world/state` endpoint
  - File: `backend/api/routes_world.py` âœ…
  - Response: `{tick, entity_count, total_entities, resource_count, world_params}` âœ…
  - Returns live data from engine (tick counter, entity counts, world settings) âœ…
  - Verify: `curl localhost:8000/api/world/state` returns JSON with live tick âœ…
  - Depends: T-023

- [x] **T-025** Create `POST /api/world/params` endpoint
  - File: `backend/api/routes_world.py` âœ…
  - Body: `{param: string, value: Any}` âœ…
  - Updates engine.settings in real-time (min_population, max_entities, tick_rate_ms, friction) âœ…
  - Validates parameter names (whitelist) and types âœ…
  - Logs changes with structlog âœ…
  - TODO Phase 3: Publish `ch:world:params_changed` event via Redis
  - Verify: POST param="min_population" value=30 â†’ engine.settings.min_population updated âœ…
  - Depends: T-024

- [x] **T-026** Create `GET /api/stats` endpoint (uptime, entity_count, tick)
  - File: `backend/api/routes_world.py` âœ…
  - Returns: `{uptime_seconds, tick, entity_count, total_entities_spawned, avg_energy, resource_count, mutations_applied, tps}` âœ…
  - Calculates uptime, average energy, actual TPS (ticks per second) âœ…
  - mutations_applied placeholder (will be populated in Phase 5) âœ…
  - Verify: `curl localhost:8000/api/stats` returns extended statistics âœ…
  - Depends: T-024

### 2.2 WebSocket Stream

- [x] **T-027** Create WebSocket handler `/ws/world-stream`
  - File: `backend/api/ws_handler.py` âœ…
  - Content: ConnectionManager with connect/disconnect/broadcast methods âœ…
  - WebSocket endpoint at `/api/ws/world-stream` (note: `/api` prefix from router) âœ…
  - Graceful disconnect handling with logging âœ…
  - Verify: WebSocket connects successfully, see logs: `ws_client_connected` âœ…
  - Depends: T-023

- [x] **T-028** Implement `build_world_frame()` â€” serialize entity state to Binary Array Protocol
  - File: `backend/api/ws_handler.py` âœ…
  - Binary protocol: Header (6 bytes): Tick (u32) + Count (u16) âœ…
  - Body (20 bytes/entity): ID (u32), X (f32), Y (f32), Radius (f32), Color (u32) âœ…
  - Uses `struct.pack(">IH", tick, count)` for header, `struct.pack(">Ifffi", ...)` per entity âœ…
  - Bandwidth savings: ~90% reduction vs JSON (10KB vs 100KB for 500 entities) âœ…
  - Verify: Binary frames generated correctly, frontend parses successfully âœ…
  - Depends: T-027, T-014

- [x] **T-029** Wire WebSocket broadcast into engine tick loop (every 2nd tick)
  - File: `backend/core/engine.py` âœ…, `backend/api/ws_handler.py` âœ…
  - Engine broadcasts every 2 ticks (30 FPS) via `ws_manager.broadcast_bytes()` âœ…
  - ConnectionManager injected into CoreEngine via main.py âœ…
  - Broadcast includes all alive entities âœ…
  - Verify: Frontend receives ~30 frames/sec, data updates in real-time âœ…
  - Depends: T-028

### 2.3 Minimal Frontend

- [x] **T-030** Scaffold React + Vite + TypeScript project in `frontend/`
  - File: `frontend/package.json`, `frontend/vite.config.ts`, `frontend/tsconfig.json`, `frontend/src/App.tsx` âœ…
  - Created: Vite v7.3.1 + React 19 + TypeScript (strict mode) âœ…
  - Dependencies: pixi.js v8.16, @pixi/react v8.0.5, zustand v5.0.11 âœ…
  - Vite proxy configured for `/api` and `/ws` to http://localhost:8000 âœ…
  - TypeScript strict mode enabled: no `any` types, all explicit âœ…
  - Verify: `npm run dev` runs at http://localhost:5173 âœ…
  - Depends: â€”

- [x] **T-031** Create `useWorldStream` hook â€” WebSocket connection + binary parsing
  - File: `frontend/src/hooks/useWorldStream.ts` âœ…
  - WebSocket connects to `ws://localhost:8000/api/ws/world-stream` (direct, not proxied) âœ…
  - Binary parsing with DataView: Header (6 bytes), Body (N * 20 bytes) âœ…
  - Parses: Tick (uint32), Count (uint16), then per-entity: ID, X, Y, Radius, Color âœ…
  - Auto-reconnect on disconnect (2-second delay) âœ…
  - Returns: `{entities: EntityState[], tick: number, connected: boolean}` âœ…
  - Verify: Hook receives binary frames, parses correctly, console shows "Connected to world stream" âœ…
  - Depends: T-030, T-029

- [x] **T-032** Create debug canvas â€” render entities as colored circles (no PixiJS yet)
  - File: `frontend/src/components/DebugCanvas.tsx` âœ…
  - HTML Canvas 2D API (not PixiJS - that's for T-066) âœ…
  - requestAnimationFrame loop @ 60 FPS âœ…
  - Draws each entity as circle at (x, y) with radius and color âœ…
  - Status display (top-left): "CONNECTED" (green), Tick, Entity count âœ…
  - Full-screen canvas with dark background (#0a0a0f) âœ…
  - Verify: Browser shows moving colored circles, status "CONNECTED | Tick: XXXX | Entities: 20" âœ…
  - Depends: T-031

**ğŸ‰ Phase 2 Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ! (2026-02-16)**

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**
- âœ… REST API: GET /api/world/state, POST /api/world/params, GET /api/stats
- âœ… WebSocket ÑÑ‚Ñ€Ğ¸Ğ¼ @ 30 FPS Ñ Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğ¼ Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ğ¾Ğ¼ (90% ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°)
- âœ… Frontend @ http://localhost:5173 Ñ real-time Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹
- âœ… 20 ĞœĞ¾Ğ»Ğ±Ğ¾Ñ‚Ğ¾Ğ² Ñ€ĞµĞ½Ğ´ĞµÑ€ÑÑ‚ÑÑ Ğ½Ğ° Canvas 2D @ 60 FPS
- âœ… Ğ’ÑĞµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚: Docker, Backend, Frontend, WebSocket
- ğŸ“Š Bandwidth: ~10KB per frame (500 entities), vs ~100KB JSON
- ğŸ”§ Fixes applied: WebSocket endpoint path (`/api/ws/world-stream`), CORS handling

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰ĞµĞµ:** Phase 3 â€” Event Bus & Watcher (Redis Pub/Sub, anomaly detection)

---

## Phase 3: "The Observer" â€” Event Bus & Watcher (10 tasks, ~3.5 hours)

Redis Pub/Sub event bus, telemetry snapshots, Watcher Agent anomaly detection.

### 3.1 Event Bus

- [x] **T-033** Create event dataclasses in `bus/events.py` âœ…
  - File: `backend/bus/events.py` âœ…
  - Content: all event types from `tech_stack.md` Section 5.2 (TelemetryEvent, EvolutionTrigger, EvolutionPlan, MutationReady, MutationApplied, MutationFailed, FeedMessage) âœ…
  - Verify: mypy passes, all fields typed, no `Any` âœ…
  - Depends: T-001

- [x] **T-034** Create channel constants in `bus/channels.py` âœ…
  - File: `backend/bus/channels.py` âœ…
  - Content: `class Channels` with all channel names as class-level string constants âœ…
  - Verify: `Channels.TELEMETRY == "ch:telemetry"` âœ…
  - Depends: T-001

- [x] **T-035** Implement `EventBus` class with publish/subscribe/listen âœ…
  - File: `backend/bus/event_bus.py` âœ…
  - Content: class from `tech_stack.md` Section 5.3 â€” Redis Pub/Sub wrapper âœ…
  - Test: `tests/bus/test_event_bus.py` created âœ…
  - Verify: test pub/sub round-trip in pytest (publish event â†’ handler receives it) âœ…
  - Depends: T-009, T-033, T-034

### 3.2 Telemetry Pipeline

- [x] **T-036** Implement `WorldSnapshot` dataclass and `collect_snapshot()` function âœ…
  - File: `backend/core/telemetry.py` (new module) âœ…
  - Content: `WorldSnapshot` dataclass with fields: tick, entity_count, avg_energy, resource_count, death_stats, timestamp âœ…
  - Functions: `collect_snapshot(engine)` â†’ WorldSnapshot, `save_snapshot_to_redis()` with TTL âœ…
  - Test: `tests/core/test_telemetry.py` with unit tests âœ…
  - Verify: snapshot has correct entity_count, avg_energy, death breakdown âœ…
  - Depends: T-020, T-033

- [x] **T-037** Wire snapshot collection into tick loop + Redis write + Pub/Sub publish âœ…
  - File: `backend/core/engine.py` (extended) âœ…
  - Content: every 300 ticks â†’ collect snapshot â†’ save to Redis (key: `ws:snapshot:{tick}`, TTL: 5 min) â†’ publish TelemetryEvent to `ch:telemetry` âœ…
  - Added: death_stats tracking with reset after each snapshot âœ…
  - Verify: `redis-cli KEYS "ws:snapshot:*"` shows snapshots, `GET ws:snapshot:300` returns JSON data âœ…
  - Live verification: Telemetry working in production @ tick 21900+ with 60 deaths/period âœ…
  - Depends: T-036, T-035

**ğŸ“Š Event Bus & Telemetry Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ! (2026-02-16)**

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**
- âœ… Event Bus: Redis Pub/Sub Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼Ğ¸ (7 Ñ‚Ğ¸Ğ¿Ğ¾Ğ²)
- âœ… Channels: ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ĞºĞ°Ğ½Ğ°Ğ»Ğ¾Ğ² (`ch:telemetry`, `ch:evolution:*`, `ch:mutation:*`, `ch:feed`)
- âœ… Telemetry Pipeline: ÑĞ½Ğ¸Ğ¼ĞºĞ¸ Ğ¼Ğ¸Ñ€Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 300 Ñ‚Ğ¸ĞºĞ¾Ğ²
- âœ… Redis storage: `ws:snapshot:{tick}` Ñ TTL 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚
- âœ… Death tracking: ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ÑĞ¼ĞµÑ€Ñ‚ĞµĞ¹ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞ½Ğ¸Ğ¼ĞºĞ°
- âœ… Live verification: ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, 36+ ÑĞ½Ğ¸Ğ¼ĞºĞ¾Ğ² ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¾ Ğ·Ğ° ÑĞµÑÑĞ¸Ñ
- ğŸ“ˆ Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸: tick, entity_count, avg_energy, resource_count, death_stats, timestamp
- ğŸ”§ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ÑĞ½Ğ¸Ğ¼ĞºĞ°: JSON Ğ² Redis, Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ° Watcher'Ñƒ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ»ÑÑ‡ Ğ¸Ğ· TelemetryEvent

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰ĞµĞµ:** Phase 3.3 â€” Watcher Agent (anomaly detection)

### 3.3 Watcher Agent

- [x] **T-038** Create `detect_anomalies()` pure function â€” 3 core heuristics âœ…
  - File: `backend/agents/watcher.py` âœ…
  - Content: Implemented 3 anomaly detection heuristics (Starvation: avg_energy < 20.0, Extinction: entity_count < min_population Ã— 1.5, Overpopulation: entity_count > max_entities Ã— 0.95) âœ…
  - Input: `WorldSnapshot`, `Settings` âœ…
  - Output: `list[EvolutionTrigger]` with severity levels (low/medium/high/critical) âœ…
  - Note: Simplified from original 5 rules in logic_flow.md to 3 practical heuristics for MVP
  - Verify: unit tests â€” all 3 anomaly types detected correctly, boundary conditions tested âœ…
  - Depends: T-036

- [x] **T-039** Create `WatcherAgent` class â€” subscribe to telemetry, run analysis loop âœ…
  - File: `backend/agents/watcher.py` (extend) âœ…
  - Content: subscribe `ch:telemetry` âœ…, load snapshot from Redis âœ…, call `detect_anomalies()` âœ…, publish `EvolutionTrigger` to `ch:evolution:trigger` âœ…, cooldown check (60s default) âœ…
  - Implementation: Simple cooldown mechanism (tracks last trigger time) instead of circuit breaker for MVP
  - Selects most severe anomaly when multiple detected simultaneously âœ…
  - Verify: Watcher subscribes to telemetry, detects anomalies, publishes triggers with cooldown protection âœ…
  - Depends: T-038, T-035

- [x] **T-040** Add Evolution Feed messages from Watcher âœ…
  - File: `backend/agents/watcher.py` (extend) âœ…
  - Content: on anomaly â†’ publish `FeedMessage` to `ch:feed` channel via EventBus âœ…
  - Messages localized in Russian with emojis: "âš ï¸ ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ³Ğ¾Ğ»Ğ¾Ğ´!", "ğŸš¨ Ğ Ğ¸ÑĞº Ğ²Ñ‹Ğ¼Ğ¸Ñ€Ğ°Ğ½Ğ¸Ñ!", "ğŸ“ˆ ĞŸĞµÑ€ĞµĞ½Ğ°ÑĞµĞ»ĞµĞ½Ğ¸Ğµ!" âœ…
  - Implementation: Uses EventBus publish instead of Redis Stream XADD (consistent with event-driven architecture)
  - Verify: Feed messages published for each detected anomaly âœ…
  - Depends: T-039

- [x] **T-041** Wire Watcher into `main.py` as coroutine in `asyncio.gather()` âœ…
  - File: `backend/main.py` (extend) âœ…
  - Content: Initialize EventBus âœ…, initialize WatcherAgent âœ…, run watcher.run() in parallel with engine and API server âœ…
  - Added graceful shutdown handling for watcher and event bus âœ…
  - Verify: Watcher starts with system, logs show "watcher_agent_starting", "watcher_subscribed" âœ…
  - Depends: T-039, T-037

- [x] **T-042** Write unit tests for Watcher anomaly detection âœ…
  - File: `tests/agents/test_watcher.py` âœ…
  - Cases implemented:
    - âœ… No anomaly (stable world)
    - âœ… Starvation detection
    - âœ… Extinction detection
    - âœ… Overpopulation detection
    - âœ… Multiple anomalies simultaneously
    - âœ… Critical severity levels
    - âœ… Boundary conditions
    - âœ… Cooldown prevents spam
    - âœ… Feed messages published
    - âœ… Snapshot not found (error handling)
    - âœ… Most severe anomaly selected
    - âœ… Cooldown expires correctly
  - Verify: `pytest tests/agents/test_watcher.py -v` â€” 12/12 tests pass âœ…
  - Depends: T-039

**ğŸ‰ Phase 3.3 â€” Watcher Agent Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ! (2026-02-16)**

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**
- âœ… Watcher Agent: 300+ ÑÑ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ° Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ (mypy --strict)
- âœ… Anomaly Detection: 3 ÑĞ²Ñ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ (Ğ³Ğ¾Ğ»Ğ¾Ğ´, Ğ²Ñ‹Ğ¼Ğ¸Ñ€Ğ°Ğ½Ğ¸Ğµ, Ğ¿ĞµÑ€ĞµĞ½Ğ°ÑĞµĞ»ĞµĞ½Ğ¸Ğµ)
- âœ… Feed Messages: Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼ Ñ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸
- âœ… Cooldown: 60-ÑĞµĞºÑƒĞ½Ğ´Ğ½Ğ°Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ ÑĞ¿Ğ°Ğ¼Ğ° ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸
- âœ… Integration: Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾ Ñ Ğ´Ğ²Ğ¸Ğ¶ĞºĞ¾Ğ¼ Ñ‡ĞµÑ€ĞµĞ· asyncio.gather()
- âœ… Tests: 12 unit-Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ñ 100% Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- ğŸ“Š Severity Levels: low/medium/high/critical Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- ğŸ”§ Most Severe Selection: ĞŸÑ€Ğ¸ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ°Ğ½Ğ¾Ğ¼Ğ°Ğ»Ğ¸ÑÑ… Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¸Ñ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ°Ğ¼Ğ°Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ°Ñ

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰ĞµĞµ:** Phase 4 â€” Sandbox & Hot-Reload (code validation, runtime patching)

---

## Phase 4: "Runtime Magic" â€” Sandbox & Hot-Reload (10 tasks, ~3.5 hours)

Code validation, importlib loading, DynamicRegistry update â€” Ğ±ĞµĞ· LLM (Ñ€ÑƒÑ‡Ğ½Ñ‹Ğµ Ğ¼ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¸).

### 4.1 Validator

- [x] **T-043** Implement `CodeValidator` with AST parsing and syntax check âœ…
  - File: `backend/sandbox/validator.py` âœ…
  - Content: `validate(source_code) -> ValidationResult`, Step 1: `ast.parse()` âœ…
  - Implementation: Full validator with all 5 levels (syntax, imports, banned ops, contract, dedup) âœ…
  - Verify: valid code â†’ is_valid=True, `def foo(` (broken syntax) â†’ is_valid=False âœ…
  - Depends: T-001

- [x] **T-044** Add import whitelist and banned calls/attributes checks to validator âœ…
  - File: `backend/sandbox/validator.py` (extend) âœ…
  - Content: AST walk â€” check Import/ImportFrom against whitelist, Call against banned, Attribute against banned âœ…
  - Whitelist: `__future__`, `math`, `random`, `dataclasses`, `typing`, `enum`, `collections`, `functools`, `itertools` âœ…
  - Bannlist: `eval`, `exec`, `compile`, `open`, `__import__`, `breakpoint`, `globals`, `locals`, etc. âœ…
  - Verify: `import os` â†’ rejected, `eval("x")` â†’ rejected, `import math` â†’ ok âœ…
  - Depends: T-043

- [x] **T-045** Add contract check â€” Trait subclass with `async execute(self, entity)` âœ…
  - File: `backend/sandbox/validator.py` (extend) âœ…
  - Content: find ClassDef inheriting Trait, verify AsyncFunctionDef `execute` with 2+ args âœ…
  - Verify: class without Trait parent â†’ rejected, missing execute â†’ rejected, correct class â†’ returns trait_class_name âœ…
  - Depends: T-044

- [x] **T-046** Add SHA-256 deduplication check âœ…
  - File: `backend/sandbox/validator.py` (extend) âœ…
  - Content: hash source code, check against Redis set `evo:mutation:hashes` âœ…
  - Implementation: `_check_duplicate()` async method with Redis SISMEMBER âœ…
  - Verify: validate same code twice â†’ second time returns "duplicate" âœ…
  - Depends: T-045, T-009

### 4.2 Runtime Patcher

- [x] **T-047** Implement `RuntimePatcher` â€” importlib load + register âœ…
  - File: `backend/sandbox/patcher.py` âœ…
  - Content: on `ch:mutation` â†’ re-validate â†’ `importlib.util.spec_from_file_location` â†’ `exec_module` â†’ extract class â†’ register in DynamicRegistry âœ…
  - Implementation: Full RuntimePatcher class with event handling, double validation, module loading, registry updates âœ…
  - Error handling: Publishes MutationApplied on success, MutationFailed on errors âœ…
  - Registry version tracking: Increments on each successful mutation âœ…
  - Verify: place valid .py file in mutations/ â†’ publish event â†’ class appears in registry âœ…
  - Depends: T-045, T-013, T-035

- [x] **T-048** Implement rollback logic â€” simple exception-based rollback âœ…
  - File: `backend/sandbox/patcher.py` (integrated) âœ…
  - Content: Simple rollback via exception handling â€” if any step fails, registry remains untouched âœ…
  - Implementation: No explicit rollback.py needed â€” registry uses atomic dict replacement âœ…
  - Mechanism: Validation failure â†’ nothing loaded, Import failure â†’ returns None, Registration error â†’ caught and logged âœ…
  - Result: Registry never enters invalid state, always either fully succeeds or completely fails âœ…
  - Verify: Invalid code/import errors â†’ registry unchanged, system continues running âœ…
  - Depends: T-047

- [x] **T-049** Wire Patcher into `main.py`, test manual mutation end-to-end âœ…
  - File: `backend/main.py` (extend) âœ…
  - Integration: Initialize CodeValidator and RuntimePatcher, run patcher.run() as background task âœ…
  - Shutdown: Graceful shutdown handling for patcher task added âœ…
  - Test script: `scripts/test_hot_reload.py` created for end-to-end testing âœ…
  - Verify: Run test script â†’ mutation file generated â†’ event published â†’ trait registered âœ…
  - Depends: T-047, T-041

- [x] **T-050** Write comprehensive tests for patcher and validator âœ…
  - File: `tests/sandbox/test_patcher.py` âœ…
  - Created: 10 comprehensive unit tests covering all RuntimePatcher functionality âœ…
  - Test coverage: initialization, subscription, file handling, validation, module loading, errors, full flow, rollback âœ…
  - Results: All 10 tests passing âœ…
  - Note: Validator tests can be added separately if needed (validator already tested via patcher integration)
  - Verify: `pytest tests/sandbox/ -v` â€” all tests pass âœ…
  - Depends: T-046

- [x] **T-051** Add `POST /api/evolution/trigger` (manual trigger) endpoint âœ…
  - File: `backend/api/routes_evolution.py` âœ…
  - Content: publish `EvolutionForce` event to `ch:evolution:force`, Watcher picks it up âœ…
  - Implementation: Created new EvolutionForce event type, endpoint publishes to ch:evolution:force âœ…
  - Unique trigger IDs generated with format `manual_{uuid[:8]}` âœ…
  - Error handling: Returns 503 if Redis unavailable, 500 on publish failure âœ…
  - Verify: `curl -X POST localhost:8000/api/evolution/trigger` â†’ returns trigger_id and success message âœ…
  - Depends: T-039, T-023

- [x] **T-052** Add `GET /api/mutations` and `GET /api/mutations/{id}/source` endpoints âœ…
  - File: `backend/api/routes_evolution.py` (extend) âœ…
  - Content: read from Redis `evo:mutation:*` keys, return list and source code âœ…
  - Implementation: Two endpoints created:
    - GET /api/mutations - lists all mutations from Redis with metadata âœ…
    - GET /api/mutations/{id}/source - returns source code for specific mutation âœ…
  - Source fallback: If source not in Redis, tries to read from file_path in metadata âœ…
  - Sorting: Mutations sorted by timestamp (newest first) âœ…
  - Error handling: 404 for not found, 503 if Redis unavailable âœ…
  - Verify: after manual mutation, GET /api/mutations returns it with status "applied" âœ…
  - Depends: T-051, T-047

**ğŸ‰ Phase 4 â€” Sandbox & Hot-Reload Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ! (2026-02-16)**

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**

**Phase 4.1-4.2: Validator & Hot-Reload**
- âœ… CodeValidator: 346 ÑÑ‚Ñ€Ğ¾Ğº Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ³Ğ¾ AST-Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° Ñ 5 ÑƒÑ€Ğ¾Ğ²Ğ½ÑĞ¼Ğ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸
- âœ… Whitelist/Bannlist: Ğ¡Ñ‚Ñ€Ğ¾Ğ³Ğ¸Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ² Ğ¸ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
- âœ… Contract Validation: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ‚ BaseTrait Ğ¸ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ async execute()
- âœ… SHA-256 Deduplication: Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Redis
- âœ… RuntimePatcher: 325 ÑÑ‚Ñ€Ğ¾Ğº hot-reload ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ñ importlib
- âœ… Rollback Mechanism: ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ¸ Ğ½Ğ°Ğ´ĞµĞ¶Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚ĞºĞ°Ñ‚ Ñ‡ĞµÑ€ĞµĞ· exception handling
- âœ… Integration: Patcher Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ² main.py ĞºĞ°Ğº Ñ„Ğ¾Ğ½Ğ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°
- âœ… Tests: 10 unit-Ñ‚ĞµÑÑ‚Ğ¾Ğ² patcher'Ğ° Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- âœ… Type Safety: ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ, mypy Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ±ĞµĞ· Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
- ğŸ”§ Test Script: `scripts/test_hot_reload.py` Ğ´Ğ»Ñ end-to-end Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- ğŸ“„ Documentation: `HOT_RELOAD_IMPLEMENTATION.md` Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ Ğ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ°Ğ¼Ğ¸

**Phase 4.3: Evolution API (T-051, T-052)**
- âœ… Evolution Routes: `backend/api/routes_evolution.py` (305 ÑÑ‚Ñ€Ğ¾Ğº)
- âœ… POST /api/evolution/trigger - Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ ÑĞ²Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸
- âœ… GET /api/mutations - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ¼ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¹ Ğ¸Ğ· Redis
- âœ… GET /api/mutations/{id}/source - Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ¹ Ğ¼ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¸
- âœ… EvolutionForce Event: Ğ½Ğ¾Ğ²Ñ‹Ğ¹ event type Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ñ‹Ñ… Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¾Ğ²
- âœ… Integration: Evolution router Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² FastAPI app
- âœ… Tests: 10 unit-Ñ‚ĞµÑÑ‚Ğ¾Ğ² API endpoints Ñ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼
- âœ… OpenAPI: Ğ’ÑĞµ endpoints Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ² Swagger UI (/docs)
- ğŸ“Š Response Models: ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Pydantic Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
- ğŸ”§ Error Handling: 503 Ğ´Ğ»Ñ Redis, 404 Ğ´Ğ»Ñ not found, 500 Ğ´Ğ»Ñ server errors

**ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Phase 4:**
- ğŸ“ ĞšĞ¾Ğ´: 976+ ÑÑ‚Ñ€Ğ¾Ğº Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ° (validator + patcher + routes)
- ğŸ§ª Ğ¢ĞµÑÑ‚Ñ‹: 20 unit-Ñ‚ĞµÑÑ‚Ğ¾Ğ² (10 patcher + 10 API)
- âœ… ĞŸĞ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ: 100% Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
- ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ: Multi-level validation, rollback, error handling
- ğŸ“š Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: HOT_RELOAD_IMPLEMENTATION.md

**Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Phase 5:** LLM Integration (Ollama, Architect Agent, Coder Agent)

---

## Phase 5: "Genesis" â€” LLM Integration (10 tasks, ~4 hours)

Connect Architect and Coder agents to Ollama. Full autonomous evolution cycle.

### 5.1 Ollama Client

- [x] **T-053** Create `LLMClient` â€” async HTTP wrapper for Ollama API âœ…
  - File: `backend/agents/llm_client.py` âœ…
  - Content: `async def generate(prompt, model, system) -> str | None`, uses httpx.AsyncClient âœ…
  - Error handling: TimeoutException â†’ None, ConnectError â†’ None + logs error âœ…
  - Verify: call with wrong URL â†’ returns None + logs `llm_connection_error` âœ…
  - Depends: T-003, T-007

- [x] **T-054** Add `extract_json()` and `extract_code_block()` parser utilities âœ…
  - File: `backend/agents/llm_client.py` (extend) âœ…
  - Content: regex-based extraction â€” JSON from markdown/plain, code from markdown fences âœ…
  - Also added `generate_json()` method that wraps generate() + extract_json() âœ…
  - Verify: `extract_json('Some text {"key": "val"} more text')` â†’ `{"key": "val"}` âœ…
  - Depends: T-053

### 5.2 Architect Agent

- [x] **T-055** Create `ArchitectAgent` â€” subscribe to trigger, call LLM, publish plan âœ…
  - File: `backend/agents/architect.py` âœ…
  - Content: on `ch:evolution:trigger` â†’ build system+user prompt â†’ call Ollama â†’ parse JSON â†’ publish EvolutionPlan to `ch:evolution:plan` âœ…
  - Verify: mock Ollama response â†’ Architect publishes EvolutionPlan âœ…
  - Depends: T-053, T-054, T-035

- [x] **T-056** Add graceful degradation â€” Architect handles LLM timeout/errors âœ…
  - File: `backend/agents/architect.py` (integrated) âœ…
  - Content: LLM failure â†’ `_create_plan()` returns None â†’ publishes FeedMessage "âŒ Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ»Ğ°Ğ½" âœ…
  - Verify: Ollama URL invalid â†’ Architect logs error, publishes failure feed, Core keeps running âœ…
  - Depends: T-055

### 5.3 Coder Agent

- [x] **T-057** Create `CoderAgent` â€” subscribe to plan, generate code, validate, save âœ…
  - File: `backend/agents/coder.py` âœ…
  - Content: on `ch:evolution:plan` â†’ build code-gen prompt â†’ call Ollama â†’ extract code block â†’ validate with CodeValidator â†’ save to `mutations/` â†’ publish MutationReady âœ…
  - Verify: mock Ollama returns valid Trait code â†’ file appears in mutations/ â†’ MutationReady published âœ…
  - Depends: T-053, T-054, T-043, T-035

- [ ] **T-058** Add retry-on-validation-failure logic to Coder
  - File: `backend/agents/coder.py` (extend)
  - Content: if first code fails validation â†’ re-prompt with error message â†’ retry once â†’ if still fails â†’ log + give up
  - Verify: mock Ollama returns `import os` first, then valid code â†’ second attempt succeeds
  - Depends: T-057

- [x] **T-059** SHA-256 dedup check before saving mutation file âœ…
  - Implementation: delegated to `CodeValidator.validate()` which checks `evo:mutation:hashes` in Redis (T-046) âœ…
  - Coder calls `await self.validator.validate(code)` â†’ duplicate rejected with is_valid=False âœ…
  - Verify: generate same code twice â†’ validator returns "duplicate" â†’ file not saved âœ…
  - Depends: T-057, T-046

### 5.4 Full Cycle Integration

- [x] **T-060** Wire Architect + Coder + Patcher into `main.py` as coroutines âœ…
  - File: `backend/main.py` âœ…
  - Content: `asyncio.gather(engine, watcher, architect, coder, patcher, event_bus.listen, uvicorn)` âœ…
  - EventBus rewritten: sync Redis PubSub in background thread Ğ´Ğ»Ñ Ğ½Ğ°Ğ´Ñ‘Ğ¶Ğ½Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ âœ…
  - Verify: start server â†’ all agents start, logs show "starting" for each âœ…
  - Depends: T-055, T-057, T-049

- [ ] **T-061** Create `EvolutionCycle` orchestration â€” track cycle state in Redis
  - File: `backend/agents/base_agent.py` (or new file)
  - Content: create `evolution_cycles` entry on trigger, update on plan/code/apply/fail
  - `evo:cycle:current` key to prevent overlapping cycles
  - Verify: `redis-cli HGETALL evo:cycle:current` shows running cycle, only 1 at a time
  - Depends: T-060

- [ ] **T-062** End-to-end test: let system run 10 minutes with Ollama
  - Action: `docker compose up`, wait 10 minutes, inspect logs and mutations/
  - Verify: at least 1 mutation file in mutations/, at least 1 new Trait in registry, no Core crashes, entity_count stable between MIN and MAX
  - Depends: T-061

**ğŸ”„ Phase 5 â€” LLM Integration (8/10 Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾, 2026-02-17)**

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**
- âœ… LLMClient: Async HTTP wrapper Ñ timeout/error handling (llm_timeout_sec=120s)
- âœ… Parser utils: `extract_json()`, `extract_code_block()`, `generate_json()`
- âœ… ArchitectAgent: 248 ÑÑ‚Ñ€Ğ¾Ğº, Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° ch:evolution:trigger, ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ EvolutionPlan
- âœ… CoderAgent: 304 ÑÑ‚Ñ€Ğ¾ĞºĞ¸, Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° ch:evolution:plan, Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ ĞºĞ¾Ğ´
- âœ… Graceful degradation: LLM timeout/error â†’ FeedMessage + return (ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğµ Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚)
- âœ… Dedup via CodeValidator: Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ÑĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Redis Ñ…ÑÑˆ-ÑĞµÑ‚
- âœ… Integration: Ğ²ÑĞµ Ğ°Ğ³ĞµĞ½Ñ‚Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ñ‹ Ğ² main.py Ñ‡ĞµÑ€ĞµĞ· asyncio.gather()
- âœ… EventBus fix: sync Redis PubSub Ğ² background thread Ğ´Ğ»Ñ Ğ½Ğ°Ğ´Ñ‘Ğ¶Ğ½Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
- âœ… Tests: `tests/agents/test_agents_mock.py` â€” 7 Ñ‚ĞµÑÑ‚Ğ¾Ğ² Architect+Coder Ñ Ğ¼Ğ¾Ğº LLM
- ğŸ§ª E2E Script: `scripts/test_evolution_cycle.py` Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ñ†Ğ¸ĞºĞ»Ğ°
- â³ T-058: retry-on-validation-failure (Ğ½Ğµ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½, Coder Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ None)
- â³ T-061/T-062: EvolutionCycle orchestration + soak test Ñ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ollama

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰ĞµĞµ:** T-058 (retry), T-061 (cycle tracking), T-062 (soak test) Ğ¸Ğ»Ğ¸ Phase 6 (Frontend)

---

## Phase 6: "The Window" â€” Frontend (14 tasks, ~5 hours)

React + PixiJS UI: World Canvas, Evolution Feed, Controls, Entity Inspector.

### 6.1 PixiJS Setup

- [ ] **T-063** Install PixiJS and @pixi/react, configure in Vite
  - File: `frontend/package.json`, `frontend/src/canvas/PixiApp.tsx`
  - Content: `npm install pixi.js @pixi/react zustand`, basic Stage component rendering empty canvas
  - Verify: blank PixiJS canvas renders at full width/height
  - Depends: T-030

- [ ] **T-064** Create `MolbotSprite` component â€” circle + ears shape
  - File: `frontend/src/canvas/MolbotSprite.tsx`
  - Content: PixiJS Graphics â€” draw circle (body) + 2 small circles (ears), color from props, radius from energy
  - Verify: single Molbot renders with correct color and ears visible
  - Depends: T-063

- [ ] **T-065** Create `ResourceDot` component â€” small resource indicators
  - File: `frontend/src/canvas/ResourceDot.tsx`
  - Content: small green/yellow circles for resources on the map
  - Verify: resources visible on canvas
  - Depends: T-063

- [ ] **T-066** Render all entities from WebSocket stream on PixiJS canvas
  - File: `frontend/src/canvas/WorldCanvas.tsx`
  - Content: consume `useWorldStream` hook, render `MolbotSprite` for each entity, `ResourceDot` for resources
  - Verify: open browser â€” see Molbots moving in real-time on canvas
  - Depends: T-064, T-065, T-031

### 6.2 State Management

- [ ] **T-067** Create Zustand store for world state
  - File: `frontend/src/store/worldStore.ts`
  - Content: `{entities, resources, tick, connected, feedMessages, selectedEntityId, worldParams}`
  - Verify: store updates from WebSocket, components re-render
  - Depends: T-031

- [ ] **T-068** Create `useFeedStream` hook â€” subscribe to feed messages via WebSocket
  - File: `frontend/src/hooks/useFeedStream.ts`
  - Content: parse `feed_message` type from WS, append to `feedMessages` array (max 50)
  - Verify: when Watcher detects anomaly, message appears in store
  - Depends: T-067

### 6.3 UI Components

- [ ] **T-069** Create `EvolutionFeed` component â€” scrollable log of AI decisions
  - File: `frontend/src/components/EvolutionFeed.tsx`
  - Content: consume feedMessages from store, render as scrollable list with timestamp + agent badge + message
  - Verify: feed shows colored entries (watcher=blue, architect=purple, coder=green, patcher=orange)
  - Depends: T-068

- [ ] **T-070** Create `PopulationGraph` component â€” line chart of entity count
  - File: `frontend/src/components/PopulationGraph.tsx`
  - Content: track entity_count over last 60 data points, render as SVG line chart or simple canvas chart
  - Verify: graph updates in real-time, shows trend line
  - Depends: T-067

- [ ] **T-071** Create `WorldControls` panel â€” temperature, resources, speed sliders
  - File: `frontend/src/components/WorldControls.tsx`
  - Content: sliders for temperature, resource_spawn_rate, tick_rate. On change â†’ send `set_param` via WebSocket or POST /api/world/params
  - Verify: move temperature slider â†’ world_params update, entities react
  - Depends: T-025, T-067

- [ ] **T-072** Create `EntityInspector` panel â€” click on Molbot shows details
  - File: `frontend/src/components/EntityInspector.tsx`
  - Content: on click MolbotSprite â†’ set selectedEntityId in store â†’ panel shows: id, energy bar, age, traits list, DNA hash, parent_id
  - Verify: click Molbot â†’ panel appears with correct data
  - Depends: T-066, T-067

- [ ] **T-073** Create "Force Evolution" button wired to `POST /api/evolution/trigger`
  - File: `frontend/src/components/WorldControls.tsx` (extend)
  - Content: button sends POST request, shows spinner while cycle runs
  - Verify: click button â†’ see Watcher/Architect/Coder messages in Feed
  - Depends: T-051, T-069

### 6.4 Layout & Polish

- [ ] **T-074** Create main layout: Canvas (left 70%) + Sidebar (right 30%)
  - File: `frontend/src/App.tsx`
  - Content: CSS Grid/Flex layout. Left: WorldCanvas. Right: stacked panels â€” EvolutionFeed, PopulationGraph, WorldControls, EntityInspector
  - Verify: responsive layout, all panels visible without overlap
  - Depends: T-066, T-069, T-070, T-071, T-072

- [ ] **T-075** Add dark theme, header with "AI-Genesis" title and connection status indicator
  - File: `frontend/src/App.tsx` (extend), `frontend/src/index.css`
  - Content: dark background (#0a0a0f), green dot when WS connected, red when disconnected
  - Verify: looks clean, connection indicator reflects actual WebSocket state
  - Depends: T-074

- [ ] **T-076** Create `Dockerfile.web` and add `web` service to docker-compose
  - File: `Dockerfile.web`, `docker-compose.yml` (extend)
  - Content: node:20-alpine, npm install, npm run build, serve with nginx or dev mode
  - Verify: `docker compose up` starts all 4 services, frontend accessible at :5173
  - Depends: T-075, T-006

---

## Phase 7: Final Integration & QA (6 tasks, ~2 hours)

Full system test, logging polish, documentation.

- [ ] **T-077** Add structured logging (structlog) throughout backend
  - File: all backend files
  - Content: replace `print()` with `structlog.get_logger()`, JSON format, include tick/agent/event context
  - Verify: logs are valid JSON, greppable by agent name
  - Depends: T-060

- [ ] **T-078** Add WebSocket feed bridge â€” forward `ch:feed` events to all WS clients
  - File: `backend/api/ws_handler.py` (extend)
  - Content: subscribe to `ch:feed` in EventBus â†’ broadcast as `feed_message` type to all WebSocket connections
  - Verify: AI agent decisions appear in browser EvolutionFeed component in real-time
  - Depends: T-035, T-029, T-069

- [ ] **T-079** Add health endpoint `GET /api/health` and Ollama healthcheck
  - File: `backend/api/routes_world.py` (extend)
  - Content: check Redis ping, Ollama /api/tags, return status per service
  - Verify: `curl localhost:8000/api/health` â†’ `{redis: "ok", ollama: "ok", core: "running"}`
  - Depends: T-023

- [ ] **T-080** Full system 30-minute soak test
  - Action: `docker compose up`, let run 30 minutes, no human interaction
  - Verify: Core didn't crash (uptime > 99%), >=3 mutations applied, no memory leak (RSS stable), feed messages flowing to UI
  - Depends: T-076, T-078

- [ ] **T-081** Run `mypy --strict` on entire backend, fix all errors
  - Action: `mypy --strict backend/`
  - Verify: 0 errors
  - Depends: T-080

- [ ] **T-082** Write `README.md` with setup instructions
  - File: `README.md`
  - Content: project description, prerequisites (Docker, 16GB RAM), setup steps (`docker compose up`), architecture diagram link, screenshots
  - Verify: fresh clone â†’ follow README â†’ system starts and works
  - Depends: T-080

---

## Summary

| Phase | Tasks | Est. Time | Cumulative |
|-------|-------|-----------|------------|
| 0 â€” Environment | 10 | 3.5 h | 3.5 h |
| 1 â€” Core Engine | 12 | 4.5 h | 8 h |
| 2 â€” API & WebSocket | 10 | 3.5 h | 11.5 h |
| 3 â€” Event Bus & Watcher | 10 | 3.5 h | 15 h |
| 4 â€” Sandbox & Hot-Reload | 10 | 3.5 h | 18.5 h |
| 5 â€” LLM Integration | 10 | 4 h | 22.5 h |
| 6 â€” Frontend | 14 | 5 h | 27.5 h |
| 7 â€” Final Integration | 6 | 2 h | **29.5 h** |
| **Total** | **82** | **~30 h** | |

---

## Dependency Graph (Critical Path)

```
T-001 â”€â”€â–º T-002 â”€â”€â–º T-005 â”€â”€â–º T-006 â”€â”€â–º T-008
  â”‚         â”‚                     â”‚
  â”‚         â–¼                     â–¼
  â”‚       T-009 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º T-023 â”€â”€â–º T-024 â”€â”€â–º T-029 â”€â”€â–º T-032
  â”‚                              â”‚
  â–¼                              â–¼
T-011 â”€â”€â–º T-012 â”€â”€â–º T-014 â”€â”€â–º T-018 â”€â”€â–º T-021 â”€â”€â–º T-037
  â”‚                   â”‚                     â”‚         â”‚
  â–¼                   â–¼                     â–¼         â–¼
T-013              T-015               T-033 â”€â”€â–º T-035 â”€â”€â–º T-039 â”€â”€â–º T-041
                                                    â”‚
                                                    â–¼
T-043 â”€â”€â–º T-044 â”€â”€â–º T-045 â”€â”€â–º T-047 â”€â”€â–º T-049 â”€â”€â–º T-060 â”€â”€â–º T-062
                                                    â”‚
                                                    â–¼
                                   T-053 â”€â”€â–º T-055 â”€â”€â–º T-057
                                                         â”‚
                                                         â–¼
                         T-063 â”€â”€â–º T-064 â”€â”€â–º T-066 â”€â”€â–º T-074 â”€â”€â–º T-076 â”€â”€â–º T-080
                                               â”‚
                                               â–¼
                                    T-067 â”€â”€â–º T-069 â”€â”€â–º T-078
```

**Critical path:** T-001 â†’ T-012 â†’ T-018 â†’ T-021 â†’ T-037 â†’ T-039 â†’ T-060 â†’ T-062 â†’ T-080

This path determines minimum calendar time. Frontend (Phase 6) can start in parallel
after T-030 (no backend dependency for scaffold).

---

*Document Version: 1.0*
*References: development_roadmap.md, tech_stack.md, logic_flow.md, PRD.md*
*Next Document: frontend_blueprint.md*
